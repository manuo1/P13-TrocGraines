{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block title %}Troc Graines{% endblock %}
{% block main %}

<div class="container-fluid" id="homepage_container">

  <!-- presentation zone  -->
  <div class="container-fluid" id="homepage_presentation_zone">
    <div class="row">
      <div class="col-12 text-center">
          <h3>Vous souhaitez échanger ou donner</h3>
          <h4> Ajoutez vos graines sur Troc Graines pour les partager </h4>
      </div>
    </div>
  </div>

  <!-- seed search form  -->

  <div class="container-fluid mt-2" id="seed_search_form">
    <div class="row d-block justify-content-center">
      <form action="{% url 'trocgraines:homepage' %}" method="post" class="form-inline my-2 my-lg-0 mx-2">
        <div class="col-2"></div>
        {% csrf_token %}
        {{ search_form.search }}
        <button type="submit" class="btn btn-primary my-2 my-sm-0 col-lg-1" id="search_form_btn">Chercher</button>
        <div class="col-2"></div>
      </form>
    </div>
  </div>

  <hr>

  <!-- seed search results  -->

  <div class="container-fluid mt-2" id="seed_search_results">
    {% if searched_seed %}
    <h3>Votre recherche de {{searched_seed}}</h3>
    {% else %}
    <h3>Nouveautés</h3>
    {% endif %}

    {% if matching_list %}
      {% for seed in matching_list %}

      <!-- seed cards  -->

      <div class="card mb-3" id="homepage_seed_card_{{seed.id}}">
        <!-- seed card/upper part  -->
        <div class="row no-gutters">
          <!-- seed card/upper part/card photo  -->
          <div class="col-md-2">
            <img src="{{ seed.photo.url }}" class="card-img" alt="{{seed.name}}">
          </div>
          <!-- seed card/upper part/card body -->
          <div class="col-md-10">
            <div class="card-body">
              <h4 class="card-title text-white bg-primary px-2 rounded text-left">{{ seed.name }}</h4>
              <p class="card-text text-left">{{ seed.description }}</p>
            </div>
          </div>
        </div>
        <!-- seed card/footer  -->
        <div class="card-footer">
          <div class="row">
            <div class="col-lg-6">
              <small class="text-muted">ajouter le {{ seed.creation_date|date:"SHORT_DATE_FORMAT" }} par {{ seed.owner }}</small>
            </div>
            <div class="col-lg-6 text-right">
              {% if seed.available %}
              <a href="{% url 'exchange_messages:new_message' seed_id=seed.id  owner_id=seed.owner.id%}" class="btn btn-primary btn-sm">Echanger</a>
              {% else %}
              <a class="btn btn-secondary btn-sm" disabled>Non disponible pour l'instant</a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>


      {% endfor %}
    {% else %}
        <a>Nous sommes désolés,il n'y a pas encore de {{searched_seed}} sur Troc Graines</a>
    {% endif %}

  </div>
</div>
{% endblock %}
